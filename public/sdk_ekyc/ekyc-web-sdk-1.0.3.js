var ekycsdk=function(e){var t={};function i(n){if(t[n])return t[n].exports;var c=t[n]={i:n,l:!1,exports:{}};return e[n].call(c.exports,c,c.exports,i),c.l=!0,c.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var c in e)i.d(n,c,function(t){return e[t]}.bind(null,c));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=0)}([function(e,t,i){e.exports=i(1)},function(e,t,i){"use strict";function n(e){return"object"==typeof e?"{}"===JSON.stringify(e)||"[]"===JSON.stringify(e)||!e:"string"==typeof e?!e.trim():void 0===e}function c(e,t={},i,c,o,s={}){var l=new XMLHttpRequest,d=s.AUTHORIZION,a=s.TOKEN_ID,r=s.TOKEN_KEY;l.open("POST",e,!0),!n(t)&&l.setRequestHeader(t.key,t.value),l.setRequestHeader("Authorization","Bearer "+d),l.setRequestHeader("Token-id",a),l.setRequestHeader("Token-key",r),l.setRequestHeader("mac-address","WEB-001"),l.onreadystatechange=function(){4==l.readyState&&(200==l.status?c(l.responseText):o(l.responseText))},l.send(i)}function o(e){var t=new Date(e),i=""+(t.getMonth()+1),n=""+t.getDate(),c=t.getFullYear();return i.length<2&&(i="0"+i),n.length<2&&(n="0"+n),[c,i,n].join("-")}function s(e,t,i){var n={},c={},s={};n[piexif.ImageIFD.Make]="wb",n[piexif.ImageIFD.XResolution]=[t,1],n[piexif.ImageIFD.YResolution]=[i,1],n[piexif.ImageIFD.Software]="vnpt_ekyc",c[piexif.ExifIFD.DateTimeOriginal]=o(new Date),c[piexif.ExifIFD.LensMake]="LensMake",c[piexif.ExifIFD.Sharpness]=777,c[piexif.ExifIFD.LensSpecification]=[[1,1],[1,1],[1,1],[1,1]],s[piexif.GPSIFD.GPSVersionID]=[7,7,7,7],s[piexif.GPSIFD.GPSDateStamp]="1999:99:99 99:99:99";var l={"0th":n,Exif:c,GPS:s},d=piexif.dump(l);return piexif.insert(d,e)}function l(e,t){var i=btoa(JSON.stringify(e)),n=CryptoJS.AES.encrypt(i,t).toString(),c=CryptoJS.AES.decrypt(n,t).toString(CryptoJS.enc.Utf8);JSON.parse(atob(c));return n}function d(e){return decodeURIComponent(atob(e).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""))}function a(e){for(var t=atob(e.split(",")[1]),i=new ArrayBuffer(t.length),n=new Uint8Array(i),c=0;c<t.length;c++)n[c]=t.charCodeAt(c);return new Blob([i],{type:"image/jpeg"})}function r(e,t){!function(){console.log("ket-qua",e);var i=document.getElementById("vnpt_ekyc"),c='<div class="step-4" id="ekyc-step-4"><ul class="progressbar" id="progressbar" style="width:45%;margin-bottom: 27px"><li class="complete" id="progress-step0">Mặt trước</li><li  class="complete" id="progress-step1">Mặt sau</li><li  class="complete" id="progress-step2">Chân dung</li><li  class="complete" id="progress-step3">Kết quả</li></ul><div class="info-wrap"><div class="tabs"><div id="validation" class="tab"><ul class="nav nav-tabs"><li id="info-tab"><div>Thông tin cá nhân</div></li><li id="validation-tab" class="active"><div>Validation</div></li></ul><div class="block-left" id="tab2-content"><div class="item"><div class="label-cus">Loại giấy tờ</div><div class="item-content">'+(n(e)||n(e.ocr)?'<div style="color:red;">Không hợp lệ</div>':'<div style="color:green;">Hợp lệ</div>')+'</div></div><div class="item"><div class="label-cus">Mặt trước, sau giấy tờ</div></div><div class="item"><div class="label-cus">Giấy tờ mờ nhòe/mất góc</div><div class="item-content">'+(n(e)||n(e.ocr)?"":function(e){let t="";t=n(e)?'<div style="color:green;">Không</div>':'<div style="color:red;">Có</div>';return t}(e.ocr.object.warning))+'</div></div><div class="item"><div class="label-cus">Chất lượng số ID</div><div class="item-content">'+(n(e)||n(e.ocr)?"":function(e){let t=JSON.parse(e);if(n(t))return'<div style="color: red;">Mờ nhòe</div>';for(var i=0;i<t.length;i++)if(t[i]<.93)return'<div style="color: red;">Mờ nhòe</div>';return'<div style="color: green;">Tốt</div>'}(e.ocr.object.id_probs))+'</div></div><div class="item"><div class="label-cus">Chất lượng ngày cấp</div><div class="item-content">'+(n(e)||n(e.ocr)?"":function(e){if(e<.93)return'<div style="color: red;">Mờ nhòe</div>';return'<div style="color: green;">Tốt</div>'}(e.ocr.object.issue_date_prob))+'</div></div><div class="item"><div class="label-cus">Hạn giấy tờ</div><div class="item-content">'+(n(e)||n(e.ocr)?"":function(e){let t="";t="no"==e?'<div style="color:green;">Còn hạn</div>':'<div style="color:red;">Hết hạn</div>';return t}(e.ocr.object.expire_warning))+'</div></div><div class="item"><div class="label-cus">Xác thực giấy tờ</div><div class="item-content">'+(n(e)||n(e.liveness_card_front)||n(e.liveness_card_back)?"":function(e,t){let i="";i=e||t?'<div style="color:red;">Không chụp trực tiếp</div>':'<div style="color:green;">Chụp trực tiếp</div>';return i}(e.liveness_card_front.fake_liveness,e.liveness_card_back.fake_liveness))+'</div></div><div class="item"><div class="label-cus">Cảnh báo trường thông tin</div><div class="item-content">'+(n(e)||n(e.ocr)||n(e.ocr.object)?"":function(e){const t={id_sua_xoa:"Số ID bị sửa xóa",id_ko_hop_le:"Số ID không hợp lệ",id_dob_ko_khop:"Mã năm sinh không khớp",id_gender_ko_khop:"Mã giới tính không khớp",id_post_code_ko_khop:"Mã tỉnh/TP không khớp",invalid_dob:"Mã ngày sinh không hợp lệ",den_trang_ko_hop_le:"Giấy tờ photo",fake_printing:"Giấy tờ không hợp lệ",id_invalid_length:"Số ID không hợp lệ"};let i="",n=[],c=[];for(var o=0;o<e.length;o++)"id_ko_hop_le"==e[o]||"id_dob_ko_khop"==e[o]||"id_gender_ko_khop"==e[o]||"id_post_code_ko_khop"==e[o]||"invalid_dob"==e[o]?n.push(e[o]):c.push(e[o]);if(n.length>0)for(o=0;o<n.length;o++)i+='<div style="color:#ff7f00;">'+t[e[o]]+"</div>";else if(c.length>0)for(o=0;o<c.length;o++)i+='<div style="color:#ff7f00;">'+t[e[o]]+"</div>";else i='<div style="color:green;">Hợp lệ</div>';return i}(e.ocr.object.tampering.warning))+'</div></div><div class="item"><div class="label-cus">Dán đè ảnh</div><div class="item-content">'+(n(e)||n(e.liveness_card_front)?"":function(e){let t="";t=e?'<div style="color:red;">Có</div>':'<div style="color:green;">Không</div>';return t}(e.liveness_card_front.face_swapping))+'</div></div><div class="item"><div class="label-cus">Mở mắt</div><div class="item-content">'+(n(e)||n(e.liveness_face)?"":function(e){let t="";t="yes"==e?'<div style="color:green;">Có</div>':'<div style="color:red;">Không</div>';return t}(e.liveness_face.is_eye_open))+'</div></div><div class="item"><div class="label-cus">Mờ mặt</div><div class="item-content">'+(n(e)||n(e.liveness_face)?"":function(e){let t="";t="no"==e?'<div style="color:green;">Không</div>':'<div style="color:red;">Có</div>';return t}(e.liveness_face.blur_face))+'</div></div><div class="item"><div class="label-cus">Xác thực chân dung</div><div class="item-content">'+(n(e)||n(e.liveness_face)?"":function(e){let t="";t="success"==e?'<div style="color:green;">Người thật</div>':'<div style="color:red;">Không phải người thật</div>';return t}(e.liveness_face.liveness))+'</div></div><div class="item"></div></div></div><div id="info" class="tab"><ul class="nav nav-tabs"><li id="info-tab1" class="active"><div>Thông tin cá nhân</div></li><li id="validation-tab1"><div>Validation</div></li></ul><div class="block-left"><div class="item"><div class="label-cus">Giấy tờ</div><div class="item-content">'+function(){let i='<div style="color:green;" class="check-info-doc">Hợp lệ</div>';n(e)?(i='<div style="color:red;" class="check-info-doc">Không hợp lệ</div>',console.log("data empty")):(n(e.ocr)||n(e.ocr.object)?(i='<div style="color:red;" class="check-info-doc">Không hợp lệ</div>',console.log("ocr || obj empty")):n(e.ocr.object.expire_warning)||"yes"==e.ocr.object.expire_warning&&(i='<div style="color:red;" class="check-info-doc">Không hợp lệ</div>',console.log("data.ocr.object.expire_warning")),n(e.liveness_card_front)||n(e.liveness_card_back)?t.CHECK_LIVENESS_CARD&&(i='<div style="color:red;" class="check-info-doc">Không hợp lệ</div>',console.log("liveness_card_front || liveness_card_back")):(e.liveness_card_front.face_swapping&&(i='<div style="color:red;" class="check-info-doc">Không hợp lệ</div>',console.log("data.liveness_card_front.face_swapping")),e.liveness_card_front.fake_liveness&&(i='<div style="color:red;" class="check-info-doc">Không hợp lệ</div>',console.log("data.liveness_card_front.fake_liveness")),e.liveness_card_front.fake_print_photo&&(i='<div style="color:red;" class="check-info-doc">Không hợp lệ</div>',console.log("data.liveness_card_front.fake_print_photo")),e.liveness_card_back.face_swapping&&(i='<div style="color:red;" class="check-info-doc">Không hợp lệ</div>',console.log("data.liveness_card_back.face_swapping")),e.liveness_card_back.fake_liveness&&(i='<div style="color:red;" class="check-info-doc">Không hợp lệ</div>',console.log("data.liveness_card_back.face_swapping")),e.liveness_card_back.fake_print_photo&&(i='<div style="color:red;" class="check-info-doc">Không hợp lệ</div>',console.log("data.liveness_card_back.fake_print_photo"))));if(!n(e)&&!n(e.ocr)&&!n(e.ocr.object.warning_msg)){let t=e.ocr.object.warning_msg;i="";for(var c=0;c<t.length;c++)i+='<div style="color:#ff7f00;">'+t[c]+"</div>";console.log("data.ocr.object.warning",i)}return i}()+'</div></div><div class="item"><div class="label-cus">Số ID</div><div class="item-content">'+(n(e)||n(e.ocr)?"":e.ocr.object.id)+'</div></div><div class="item"><div class="label-cus">Họ và tên</div><div class="item-content">'+(n(e)||n(e.ocr)?"":e.ocr.object.name)+'</div></div><div class="item"><div class="label-cus">Ngày sinh</div><div class="item-content">'+(n(e)||n(e.ocr)?"":e.ocr.object.birth_day)+'</div></div><div class="item"><div class="label-cus">Nơi ĐKHK TT</div><div class="item-content">'+(n(e)||n(e.ocr)?"":e.ocr.object.recent_location)+'</div></div><div class="item"><div class="label-cus">Giới tính</div><div class="item-content">'+(n(e)||n(e.ocr)?"":e.ocr.object.gender)+'</div></div><div class="item"><div class="label-cus">Ngày cấp</div><div class="item-content">'+(n(e)||n(e.ocr)?"":e.ocr.object.issue_date)+'</div></div><div class="item"><div class="label-cus">Nơi cấp</div><div class="item-content">'+(n(e)||n(e.ocr)?"":e.ocr.object.issue_place)+'</div></div><div class="item"><div class="label-cus">So sánh</div><div class="item-content">'+(n(e)||n(e.compare)?'<div style="color: red;"> Không tìm thấy khuôn mặt </div>':function(e){let t="";t="NOMATCH"==e.msg?'<div style="color: red;">'+e.result+"</div>":'<div style="color: green;">'+e.result+"</div>";return t}(e.compare.object))+'</div></div></div></div></div><div class="images-block"><img class="image-result" src="'+(!n(e)&&!n(e.image_base64)&&e.image_base64.img_front)+'"/><img class="image-result" src="'+(!n(e)&&!n(e.image_base64)&&e.image_base64.img_back)+'"/><img class="image-result" src="'+(!n(e)&&!n(e.image_base64)&&e.image_base64.img_face)+'"/></div></div><div class="btn-redemo" id="btn-redemo"><img src="https://ekyc.bionicmachine.co/images/refresh_icon.png" style="width: 20px; height: 20px; margin-right: 5px"/><span>THỰC HIỆN LẠI</span></div></div>';i.insertAdjacentHTML("beforeend",c),document.getElementById("btn-redemo").addEventListener("click",(function(){})),document.getElementById("info-tab").addEventListener("click",(function(){let e=document.getElementById("validation"),t=document.getElementById("info");e.style.display="none",t.style.display="block"})),document.getElementById("info-tab1").addEventListener("click",(function(){let e=document.getElementById("validation"),t=document.getElementById("info");e.style.display="none",t.style.display="block"})),document.getElementById("validation-tab").addEventListener("click",(function(){let e=document.getElementById("validation"),t=document.getElementById("info");e.style.display="block",t.style.display="none"})),document.getElementById("validation-tab1").addEventListener("click",(function(){let e=document.getElementById("validation"),t=document.getElementById("info");e.style.display="block",t.style.display="none"}))}()}function p(e=-1,t,i){var n=400,a=null;!function(){var e=document.getElementById("vnpt_ekyc");e.insertAdjacentHTML("beforeend","<div class='step1-demo-ekyc' id='step1-demo-ekyc'><ul class='progressbar' id='progressbar'><li class='active complete' id='progress-step0'>Mặt trước</li><li id='progress-step1'>Mặt sau</li><li id='progress-step2'>Chân dung</li><li id='progress-step3'>Kết quả</li></ul><div class='ekyc-popup' id='ekyc-popup-1'><div class='pu-header'><img class='close-btn' id='close-pop-1' width='32px' height='32px' src='https://ekyc.bionicmachine.co/images/remove_icon.png' /><div class='icons'><img class='main-icons' src='https://ekyc.bionicmachine.co/images/touch_cmt.png' /></div><div class='content'>Hướng dẫn Chụp ảnh giấy tờ cầm tay</div></div><div class='pu-body'><ul><li>Đưa giấy tờ vào gần camera sao cho 4 góc của giấy tờ trùng với vùng giới hạn</li><li>Chụp rõ nét và đầy đủ thông tin trên giấy tờ</li></ul></div><div class='pu-footer'><img class='main-icons' src='https://ekyc.bionicmachine.co/images/cmt_noitice1.svg'/><img class='main-icons' src='https://ekyc.bionicmachine.co/images/cmt_noitice2.svg'/><img class='main-icons' src='https://ekyc.bionicmachine.co/images/cmt_noitice3.svg'/></div></div><div class='ekyc-popup' id='ekyc-popup-2'><div class='pu-header'><img class='close-btn' id='close-pop-2' width='32px' height='32px' src='https://ekyc.bionicmachine.co/images/remove_icon.png' /><div class='icons'><img class='main-icons' src='https://ekyc.bionicmachine.co/images/portrait_icon.png' /></div><div class='content'>Hướng dẫn Chụp ảnh Chân dung</div></div><div class='pu-body'><ul><li>Di chuyển khuôn mặt sao cho vừa với vùng giới hạn</li><li>Giữ nguyên khuôn mặt khi chụp ảnh</li><li>Hạn chế có người khác trong camera khi chụp</li></ul></div><div class='pu-footer'><img class='main-icons' src='https://ekyc.bionicmachine.co/images/portrait_noitice_1.svg'/><img class='main-icons' src='https://ekyc.bionicmachine.co/images/portrait_noitice_2.svg'/><img class='main-icons' src='https://ekyc.bionicmachine.co/images/portrait_noitice_3.svg'/></div></div><img id='tutorial_btn' class='tutorial_btn' src='https://ekyc.bionicmachine.co/images/tutorial_btn.png'></img><div class='webcame-zone' id='webcame-zone'><div class='video-block' id='video-block'><video class='action-block' id='video' autoplay='true'></video></div><div id='canvas-border'><canvas id='canvas' style='overflow:auto; display:none'></canvas></div></div><div class='ekyc_description' id='ekyc_description' ><span>Xin vui lòng</span><br/><span>Đặt giấy tờ nằm vừa khung hình chữ nhật, chụp đủ ánh sáng và rõ nét</span></div><div class='ekyc_description' id='ekyc_description2'><span>Xin vui lòng</span><br/><span>Di chuyển khuôn mặt sao cho vừa với vùng giới hạn</span></div><div class='take-picture-btn' id='take-picture-step1'><img class='camera-icon' src='https://ekyc.bionicmachine.co/images/capture_icon_w.png'></img><span class='title'>Chụp ảnh</span></div><div class='step1-after-capture' id='step1-after-capture'><div class='re-capture' id='step1-re-capture'><img class='camera-icon' src='https://ekyc.bionicmachine.co/images/capture_icon_b.png'></img><span>Chụp lại</span></div><div class='next-step' id='step1-next-step'><img class='next-icon' src='https://ekyc.bionicmachine.co/images/next_icon_b.png'></img><span>Tiếp theo</span></div></div><div id='dropZone' class='id-card'><div class='capture-btn-wrapper'><img class='img-capture-mobile' src='https://ekyc.bionicmachine.co/images/capure_mobile.png'></img><input id='fileInputMobile' type='file' accept='image/*' capture='environment'><div style='color: #18d696'>Chạm để chụp ảnh</div></div></div><div class='preview' id='previewZone'><img id='preview-img' src='' alt='preview' /></div><div class='ekyc_description' id='ekyc_description_mobile1' ><span>Xin vui lòng</span><br/><span>Đặt giấy tờ nằm vừa khung hình chữ nhật,</span><br/><span> chụp đủ ánh sáng và rõ nét</span></div><div class='ekyc_description' id='ekyc_description_mobile2'><span>Xin vui lòng</span><br/><span>Di chuyển khuôn mặt sao cho vừa </span><br/><span>với vùng giới hạn</span></div><div class='mobile-after-capture' id='mobile-after-capture'><div class='upload-btn-wrapper'><button class='btn-active'><img class='camera-icon' src='https://ekyc.bionicmachine.co/images/capture_icon_b.png'></img><span>Chụp lại</span></button><input id='fileInputMobile1' type='file' accept='image/*' capture='environment'></div><div class='next-step' id='mobile-next-step'><img class='next-icon' src='https://ekyc.bionicmachine.co/images/next_icon_b.png'></img><span>Tiếp theo</span></div></div><div class='tutorial-mobile'><a id='tutorial-mobile'>Hướng dẫn</a></div></div>"),document.getElementById("step1-after-capture").style.display="none";var i=document.querySelector("#video");document.getElementById("ekyc_description").style.display="none",document.getElementById("webcame-zone").style.display="none",document.getElementById("ekyc_description2").style.display="none",document.getElementById("take-picture-step1").style.display="none",document.getElementById("ekyc-popup-2").style.display="none",document.getElementById("dropZone").style.display="none",document.getElementById("ekyc_description_mobile1").style.display="none",document.getElementById("tutorial-mobile").style.display="none";try{var r=window.screen.width<window.outerWidth?window.screen.width:window.outerWidth;if(navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,r>500&&navigator.mediaDevices.getUserMedia){var y={audio:!1,video:{facingMode:"user"}};navigator.mediaDevices.getUserMedia(y).then((function(e){if(i.srcObject=e,(e.getVideoTracks()[0].label?e.getVideoTracks()[0].label.toLowerCase():"anonymous").includes("fake")){let t=d("VnVpIGzDsm5nIGtp4buDbSB0cmEgY2FtZXJhIGPhu6dhIGLhuqFuICE=");alert(t),b(e),location.reload()}else i.play(),document.getElementById("take-picture-step1").addEventListener("click",(function(){p+=1;var e=document.getElementById("canvas"),i=document.getElementById("video"),d=document.getElementById("tutorial_btn"),r=Math.round(i.videoHeight/(i.videoWidth/n));d.style.display="none",e.width=n,e.height=r,e.getContext("2d").drawImage(i,0,0,n,r),h=s(h=e.toDataURL("image/jpeg"),n,r),document.getElementById("canvas-border").style.height=r+"px";var y={image_type:"jpeg",width:n,height:r,brand:"wb",date_taken:o(new Date),soft_ware:"vnpt_ekyc"};a=l(y,"3cb7ecbd-2343-4272-b2f1-cdb12983ecc0");var g=function(e){for(var t=atob(e.split(",")[1]),i=new ArrayBuffer(t.length),n=new Uint8Array(i),c=0;c<t.length;c++)n[c]=t.charCodeAt(c);return new Blob([i],{type:"image/jpeg"})}(h);if(1===p)try{var b=u+"file-service/v1/addFile";(f=new FormData).append("file\t",g),f.append("title\t","upload_cmt_front"),f.append("description\t","upload_cmt_front"),v.img_front=h,c(b,{},f,e=>{var i=JSON.parse(e);m.img_front=i.object.hash,_(u+"ai/v2/web/card/liveness",i.object.hash,"liveness_card_front",t.CHECK_LIVENESS_CARD)},e=>{console.log(e)},t),document.getElementById("step1-next-step").setAttribute("data-step",p)}catch(e){console.log("err",e)}else if(2===p)try{b=u+"file-service/v1/addFile",(f=new FormData).append("file\t",g),f.append("title\t","upload_cmt_back"),f.append("description\t","upload_cmt_back"),v.img_back=h,c(b,{},f,e=>{var i=JSON.parse(e);m.img_back=i.object.hash,_(u+"ai/v2/web/card/liveness",i.object.hash,"liveness_card_back",t.CHECK_LIVENESS_CARD)},e=>{console.log(e)},t),document.getElementById("step1-next-step").setAttribute("data-step",p)}catch(e){console.log("err",e)}else if(3===p)try{var f;b=u+"file-service/v1/addFile",(f=new FormData).append("file\t",g),f.append("title\t","upload_face_image"),f.append("description\t","upload_face_image"),v.img_face=h,c(b,{},f,e=>{var i=JSON.parse(e);m.img_face=i.object.hash,k(u+"ai/v2/web/face/liveness",m.img_face,"liveness_face",t.CHECK_LIVENESS_FACE)},e=>{console.log(e)},t),document.getElementById("step1-next-step").setAttribute("data-step",p)}catch(e){console.log("err",e)}let E=document.getElementById("video-block"),I=document.getElementById("canvas-border");e.style.display="block",I.style.display="block",E.style.display="none",this.style.display="none",document.getElementById("step1-after-capture").style.display="flex",bodymovin.loadAnimation({container:document.getElementById("canvas-border"),renderer:"svg",loop:!1,autoplay:!0,name:"Hello World"})})),function(e=""){document.getElementById("step1-next-step").onclick=function(){let t=this.getAttribute("data-step"),i=document.getElementById("video-block"),n=document.getElementById("tutorial_btn");if(n.style.display="block",w("progress-step"+t),document.getElementById("step1-after-capture").style.display="none",i.style.display="block",f(),document.getElementById("take-picture-step1").style.display="flex",2==t)S(),document.getElementById("ekyc-popup-2").style.display="block",n.style.display="none",E(u+"ai/v2/web/ocr/id"),document.getElementById("ekyc_description").style.display="none";else if(3==t){B(u+"ai/v2/web/face/compare"),I(u+"ai/v2/web/face/mask"),document.getElementById("step1-demo-ekyc").style.display="none";var c="<div class='ekyc-loading' id='ekyc-loading'><div class='arc'></div></div>";document.getElementById("vnpt_ekyc").insertAdjacentHTML("beforeend",c),b(e),g.image_base64=v}}}(e)})).catch((function(e){console.log("Something went wrong!",e);let t=d("VnVpIGzDsm5nIGtp4buDbSB0cmEgY2FtZXJhIGPhu6dhIGLhuqFuICE=");alert(t)}))}}catch(e){console.log("err webcam",e)}function j(e,i){document.getElementById("mobile-next-step").onclick=function(){p+=1;!function(e,i,n){try{var o=u+"file-service/v1/addFile",s=new FormData;s.append("file\t",e),s.append("title\t","upload_cmt_front"),s.append("description\t","upload_cmt_front"),c(o,{},s,e=>{i(e)},e=>{n(e)},t)}catch(e){console.log("err",e)}}(e,e=>{var n=JSON.parse(e);if(1===p&&(m.img_front=n.object.hash,v.img_front=i,_(u+"ai/v1/web/card/liveness",n.object.hash,"liveness_card_front",t.CHECK_LIVENESS_CARD),document.getElementById("dropZone").style.display="block",document.getElementById("previewZone").style.display="none",document.getElementById("preview-img").src=""),2===p&&(m.img_back=n.object.hash,v.img_back=i,E(u+"ai/v1/web/ocr/id"),_(u+"ai/v1/web/card/liveness",n.object.hash,"liveness_card_back",t.CHECK_LIVENESS_CARD),document.getElementById("dropZone").style.display="block",document.getElementById("previewZone").style.display="none",document.getElementById("preview-img").src="",document.getElementById("ekyc-popup-2").style.display="block",document.getElementById("tutorial-mobile").style.display="none",document.getElementById("dropZone").style.display="none",document.getElementById("ekyc_description_mobile1").style.display="none"),3===p){document.getElementById("vnpt_ekyc").insertAdjacentHTML("beforeend","<div class='ekyc-loading' id='ekyc-loading'><div class='arc'></div></div>"),m.img_face=n.object.hash,v.img_face=i,g.image_base64=v,k(u+"ai/v1/web/face/liveness",n.object.hash,"liveness_face",t.CHECK_LIVENESS_FACE),B(u+"ai/v1/web/face/compare"),I(u+"ai/v1/web/face/mask"),document.getElementById("previewZone").style.display="none";let e=document.getElementById("step1-demo-ekyc");e.parentNode.removeChild(e)}},e=>{console.log("hahah",e)}),w("progress-step"+p),document.getElementById("dropZone").style.display="block",document.getElementById("tutorial-mobile").style.display="block",document.getElementById("previewZone").style.display="none",document.getElementById("mobile-after-capture").style.display="none"}}document.getElementById("close-pop-1").onclick=function(){(window.screen.width<window.outerWidth?window.screen.width:window.outerWidth)<500?(document.getElementById("ekyc-popup-1").style.display="none",document.getElementById("dropZone").style.display="block",document.getElementById("ekyc_description_mobile1").style.display="block",document.getElementById("tutorial-mobile").style.display="block",document.getElementById("tutorial-mobile").style.color="#18D696",document.getElementById("ekyc_description").style.display="none"):(document.getElementById("webcame-zone").style.display="block",document.getElementById("ekyc-popup-1").style.display="none",document.getElementById("take-picture-step1").style.display="flex",document.getElementById("ekyc_description").style.display="block",document.getElementById("tutorial_btn").style.display="block")},document.getElementById("close-pop-2").onclick=function(){(window.screen.width<window.outerWidth?window.screen.width:window.outerWidth)<500?(document.getElementById("ekyc-popup-2").style.display="none",document.getElementById("dropZone").style.display="block",document.getElementById("ekyc_description_mobile2").style.display="block",document.getElementById("tutorial-mobile").style.display="block",document.getElementById("tutorial-mobile").style.color="#18D696",document.getElementById("ekyc_description").style.display="none"):(document.getElementById("webcame-zone").style.display="block",document.getElementById("ekyc-popup-2").style.display="none",document.getElementById("take-picture-step1").style.display="flex",document.getElementById("ekyc_description2").style.display="block",document.getElementById("tutorial_btn").style.display="block")},document.getElementById("fileInputMobile").onchange=function(e){let t=new FileReader,i=this.files[0];t.onloadend=e=>{i&&j(i,e.target.result),document.getElementById("dropZone").style.display="none",document.getElementById("previewZone").style.display="block",document.getElementById("preview-img").src=t.result,document.getElementById("mobile-after-capture").style.display="flex",document.getElementById("tutorial-mobile").style.display="none"},t.readAsDataURL(i)},document.getElementById("fileInputMobile1").onchange=function(e){let t=new FileReader,i=this.files[0];t.onloadend=e=>{i&&j(i,e.target.result),document.getElementById("dropZone").style.display="none",document.getElementById("previewZone").style.display="block",document.getElementById("preview-img").src=t.result,document.getElementById("mobile-after-capture").style.display="flex"},t.readAsDataURL(i)},document.getElementById("tutorial_btn").onclick=function(){parseInt(p)<=1?(S(),document.getElementById("ekyc-popup-1").style.display="block"):(S(),document.getElementById("ekyc-popup-2").style.display="block")},document.getElementById("tutorial-mobile").onclick=function(){parseInt(p)<=1?(document.getElementById("ekyc-popup-1").style.display="block",document.getElementById("dropZone").style.display="none",document.getElementById("ekyc_description_mobile1").style.display="none",document.getElementById("tutorial-mobile").style.display="none"):(document.getElementById("ekyc-popup-2").style.display="block",document.getElementById("dropZone").style.display="none",document.getElementById("ekyc_description_mobile2").style.display="none",document.getElementById("tutorial-mobile").style.display="none")}}(),document.getElementById("step1-re-capture").addEventListener("click",(function(){p-=1;let e=document.getElementById("video-block");document.getElementById("step1-after-capture").style.display="none",e.style.display="block",document.getElementById("take-picture-step1").style.display="flex",document.getElementById("tutorial_btn").style.display="block",f()}));var p=0,m={},v={},y={},g={type_document:e},u="https://api.idg.vnpt.vn/";function b(e){e.getTracks().forEach((function(e){"live"==e.readyState&&e.stop()}))}var h="";function f(){let e="";document.getElementById("canvas-border").remove(),e="<div id='canvas-border'><canvas id='canvas' style='overflow:auto; display:none'></canvas></div>",document.getElementById("webcame-zone").insertAdjacentHTML("beforeend","<div id='canvas-border'><canvas id='canvas' style='overflow:auto; display:none'></canvas></div>"),document.getElementById("canvas-border").style.display="none"}function _(e,i,n,o=!1){let s={img:i,client_session:"9fb8ee41-1b6d-45c9-9ff4-645bb269df7e-1566189277196",token:"sdk-web-e41-1b6d-45c9-9",optimizer:a};c(e,{key:"Content-Type",value:"application/json"},JSON.stringify(s),e=>{let t=JSON.parse(e);y[n]=t.object,g[n]=o?t:null,localStorage.ekyc_result=JSON.stringify(g)},e=>{console.log(e),g[n]=JSON.parse(e)},t)}function k(e,i,n,o=!1){let s={img:i,client_session:"9fb8ee41-1b6d-45c9-9ff4-645bb269df7e-1566189277196",token:"sdk-web-e41-1b6d-45c9-9",optimizer:a};c(e,{key:"Content-Type",value:"application/json"},JSON.stringify(s),e=>{let t=JSON.parse(e);y[n]=t.object,g[n]=o?t:null,localStorage.ekyc_result=JSON.stringify(g)},e=>{console.log(e),g[n]=JSON.parse(e)},t)}function E(i,n=!0){let o={img_front:m.img_front,img_back:m.img_back,client_session:"9fb8ee41-1b6d-45c9-9ff4-645bb269df7e-1566189277196",token:"e41-1b6d-45c9-9",type:e,crop_param:"",validate_postcode:!0,optimizer:a};c(i,{key:"Content-Type",value:"application/json"},JSON.stringify(o),e=>{var t=JSON.parse(e);y.ocr=t,g.ocr=n?t:null,localStorage.ekyc_result=JSON.stringify(g)},e=>{e=JSON.parse(e);y.orc_err=e,g.ocr=e},t)}function I(e,i=!1){let n={img:m.img_face,face_bbox:"136;95;530;569",face_lmark:"235;309;390;248;346;375;325;477;450;428",client_session:"9fb8ee41-1b6d-45c9-9ff4-645bb269df7e-1566189277196",optimizer:a};c(e,{key:"Content-Type",value:"application/json"},JSON.stringify(n),e=>{var t=JSON.parse(e);y.masked=t,g.masked=i?t:null,localStorage.ekyc_result=JSON.stringify(g)},e=>{console.log(e),g.masked=JSON.parse(e)},t)}function B(e,n=!0){let o={img_front:m.img_front,img_face:m.img_face,client_session:"9fb8ee41-1b6d-45c9-9ff4-645bb269df7e-1566189277196",token:"abc",optimizer:a};y.image_base64=v,c(e,{key:"Content-Type",value:"application/json"},JSON.stringify(o),(function(e){var c=JSON.parse(e);y.compare=c,g.hash_img=m,g.compare=n?c:null,i(g),localStorage.ekyc_result=JSON.stringify(g),document.getElementById("ekyc-loading")&&(document.getElementById("ekyc-loading").style.display="none"),t.VIEW_RESULT_DEFAULT&&r(y,t)}),(function(e){g.compare=JSON.parse(e),i(g),document.getElementById("ekyc-loading")&&(document.getElementById("ekyc-loading").style.display="none"),t.VIEW_RESULT_DEFAULT&&r(y,t),console.log(e)}),t)}function w(e){var t=document.querySelectorAll(".active");[].forEach.call(t,(function(e){e.classList.remove("active")}));!e.includes("undefined")&&(document.getElementById(e).className="active complete")}function S(){document.getElementById("webcame-zone").style.display="none",document.getElementById("take-picture-step1").style.display="none",document.getElementById("ekyc_description").style.display="none",document.getElementById("ekyc_description2").style.display="none",document.getElementById("tutorial_btn").style.display="none"}}function m(e,t){!function(){console.log("ket-qua",e);var i=document.getElementById("vnpt_ekyc"),c='<div class="step-4" id="ekyc-step-4"><ul class="progressbar" id="progressbar" style="width:45%;margin-bottom: 27px"><li class="complete" id="progress-step0">Mặt trước</li><li  class="complete" id="progress-step1">Chân dung</li><li  class="complete" id="progress-step2">Kết quả</li></ul><div class="info-wrap"><div class="tabs"><div id="validation" class="tab"><ul class="nav nav-tabs"><li id="info-tab"><div>Thông tin cá nhân</div></li><li id="validation-tab" class="active"><div>Validation</div></li></ul><div class="block-left" id="tab2-content"><div class="item"><div class="label-cus">Loại giấy tờ</div><div class="item-content">'+(n(e)||n(e.ocr)?'<div style="color:red;">Không hợp lệ</div>':'<div style="color:green;">Hợp lệ</div>')+'</div></div><div class="item"><div class="label-cus">Giấy tờ mờ nhòe/mất góc</div><div class="item-content">'+(n(e)||n(e.ocr)?"":function(e){let t="";t=n(e)?'<div style="color:green;">Không</div>':'<div style="color:red;">Có</div>';return t}(e.ocr.object.warning))+'</div></div><div class="item"><div class="label-cus">Chất lượng số ID</div><div class="item-content">'+(n(e)||n(e.ocr)?"":function(e){let t=JSON.parse(e);if(n(t))return'<div style="color: red;">Mờ nhòe</div>';for(var i=0;i<t.length;i++)if(t[i]<.93)return'<div style="color: red;">Mờ nhòe</div>';return'<div style="color: green;">Tốt</div>'}(e.ocr.object.id_probs))+'</div></div><div class="item"><div class="label-cus">Chất lượng ngày cấp</div><div class="item-content">'+(n(e)||n(e.ocr)?"":function(e){if(e<.93)return'<div style="color: red;">Mờ nhòe</div>';return'<div style="color: green;">Tốt</div>'}(e.ocr.object.issue_date_prob))+'</div></div><div class="item"><div class="label-cus">Hạn giấy tờ</div><div class="item-content">'+(n(e)||n(e.ocr)?"":function(e){let t="";t="no"==e?'<div style="color:green;">Còn hạn</div>':'<div style="color:red;">Hết hạn</div>';return t}(e.ocr.object.expire_warning))+'</div></div><div class="item"><div class="label-cus">Xác thực giấy tờ</div><div class="item-content">'+(n(e)||n(e.liveness_card_front)?'<div style="color:red;">Không chụp trực tiếp</div>':function(e){let t="";t=e?'<div style="color:red;">Không chụp trực tiếp</div>':'<div style="color:green;">Chụp trực tiếp</div>';return t}(e.liveness_card_front.fake_liveness))+'</div></div><div class="item"><div class="label-cus">Cảnh báo trường thông tin</div><div class="item-content">'+(n(e)||n(e.ocr)||n(e.ocr.object)?"":function(e){const t={id_sua_xoa:"Số ID bị sửa xóa",id_ko_hop_le:"Số ID không hợp lệ",id_dob_ko_khop:"Mã năm sinh không khớp",id_gender_ko_khop:"Mã giới tính không khớp",id_post_code_ko_khop:"Mã tỉnh/TP không khớp",invalid_dob:"Mã ngày sinh không hợp lệ",den_trang_ko_hop_le:"Giấy tờ photo",fake_printing:"Giấy tờ không hợp lệ",id_invalid_length:"Số ID không hợp lệ"};let i="",n=[],c=[];for(var o=0;o<e.length;o++)"id_ko_hop_le"==e[o]||"id_dob_ko_khop"==e[o]||"id_gender_ko_khop"==e[o]||"id_post_code_ko_khop"==e[o]||"invalid_dob"==e[o]?n.push(e[o]):c.push(e[o]);if(n.length>0)for(o=0;o<n.length;o++)i+='<div style="color:#ff7f00;">'+t[e[o]]+"</div>";else if(c.length>0)for(o=0;o<c.length;o++)i+='<div style="color:#ff7f00;">'+t[e[o]]+"</div>";else i='<div style="color:green;">Hợp lệ</div>';return i}(e.ocr.object.tampering.warning))+'</div></div><div class="item"><div class="label-cus">Dán đè ảnh</div><div class="item-content">'+(n(e)||n(e.liveness_card_front)?"":function(e){let t="";t=e?'<div style="color:red;">Có</div>':'<div style="color:green;">Không</div>';return t}(e.liveness_card_front.face_swapping))+'</div></div><div class="item"><div class="label-cus">Mở mắt</div><div class="item-content">'+(n(e)||n(e.liveness_face)?"":function(e){let t="";t="yes"==e?'<div style="color:green;">Có</div>':'<div style="color:red;">Không</div>';return t}(e.liveness_face.is_eye_open))+'</div></div><div class="item"><div class="label-cus">Mờ mặt</div><div class="item-content">'+(n(e)||n(e.liveness_face)?"":function(e){let t="";t="no"==e?'<div style="color:green;">Không</div>':'<div style="color:red;">Có</div>';return t}(e.liveness_face.blur_face))+'</div></div><div class="item"><div class="label-cus">Xác thực chân dung</div><div class="item-content">'+(n(e)||n(e.liveness_face)?"":function(e){let t="";t="success"==e?'<div style="color:green;">Người thật</div>':'<div style="color:red;">Không phải người thật</div>';return t}(e.liveness_face.liveness))+'</div></div><div class="item"></div></div></div><div id="info" class="tab"><ul class="nav nav-tabs"><li id="info-tab1" class="active"><div>Thông tin cá nhân</div></li><li id="validation-tab1"><div>Validation</div></li></ul><div class="block-left"><div class="item"><div class="label-cus">Giấy tờ</div><div class="item-content">'+function(){let i='<div style="color:green;" class="check-info-doc">Hợp lệ</div>';n(e)?(i='<div style="color:red;" class="check-info-doc">Không hợp lệ</div>',console.log("data empty")):(n(e.ocr)||n(e.ocr.object)?(i='<div style="color:red;" class="check-info-doc">Không hợp lệ</div>',console.log("ocr || obj empty")):n(e.ocr.object.expire_warning)||"yes"==e.ocr.object.expire_warning&&(i='<div style="color:red;" class="check-info-doc">Không hợp lệ</div>',console.log("data.ocr.object.expire_warning")),n(e.liveness_card_front)?t.CHECK_LIVENESS_CARD&&(i='<div style="color:red;" class="check-info-doc">Không hợp lệ</div>',console.log("liveness_card_front")):(e.liveness_card_front.face_swapping&&(i='<div style="color:red;" class="check-info-doc">Không hợp lệ</div>',console.log("data.liveness_card_front.face_swapping")),e.liveness_card_front.fake_liveness&&(i='<div style="color:red;" class="check-info-doc">Không hợp lệ</div>',console.log("data.liveness_card_front.fake_liveness")),e.liveness_card_front.fake_print_photo&&(i='<div style="color:red;" class="check-info-doc">Không hợp lệ</div>',console.log("data.liveness_card_front.fake_print_photo"))));if(!n(e)&&!n(e.ocr)&&!n(e.ocr.object.warning_msg)){let t=e.ocr.object.warning_msg;i="";for(var c=0;c<t.length;c++)i+='<div style="color:#ff7f00;">'+t[c]+"</div>";console.log("data.ocr.object.warning",i)}return i}()+'</div></div><div class="item"><div class="label-cus">Số ID</div><div class="item-content">'+(n(e)||n(e.ocr)?"":e.ocr.object.id)+'</div></div><div class="item"><div class="label-cus">Họ và tên</div><div class="item-content">'+(n(e)||n(e.ocr)?"":e.ocr.object.name)+'</div></div><div class="item"><div class="label-cus">Ngày sinh</div><div class="item-content">'+(n(e)||n(e.ocr)?"":e.ocr.object.birth_day)+'</div></div><div class="item"><div class="label-cus">Nơi ĐKHK TT</div><div class="item-content">'+(n(e)||n(e.ocr)?"":e.ocr.object.recent_location)+'</div></div><div class="item"><div class="label-cus">Giới tính</div><div class="item-content">'+(n(e)||n(e.ocr)?"":e.ocr.object.gender)+'</div></div><div class="item"><div class="label-cus">Ngày cấp</div><div class="item-content">'+(n(e)||n(e.ocr)?"":e.ocr.object.issue_date)+'</div></div><div class="item"><div class="label-cus">Nơi cấp</div><div class="item-content">'+(n(e)||n(e.ocr)?"":e.ocr.object.issue_place)+'</div></div><div class="item"><div class="label-cus">So sánh</div><div class="item-content">'+(n(e)||n(e.compare)?'<div style="color: red;"> Không tìm thấy khuôn mặt </div>':function(e){let t="";t="NOMATCH"==e.msg?'<div style="color: red;">'+e.result+"</div>":'<div style="color: green;">'+e.result+"</div>";return t}(e.compare.object))+'</div></div></div></div></div><div class="images-block"><img class="image-result" src="'+(!n(e)&&!n(e.image_base64)&&e.image_base64.img_front)+'"/><img class="image-result" src="'+(!n(e)&&!n(e.image_base64)&&e.image_base64.img_face)+'"/></div></div><div class="btn-redemo" id="btn-redemo"><img src="https://ekyc.bionicmachine.co/images/refresh_icon.png" style="width: 20px; height: 20px; margin-right: 5px"/><span>THỰC HIỆN LẠI</span></div></div>';i.insertAdjacentHTML("beforeend",c),document.getElementById("btn-redemo").addEventListener("click",(function(){location.reload()})),document.getElementById("info-tab").addEventListener("click",(function(){let e=document.getElementById("validation"),t=document.getElementById("info");e.style.display="none",t.style.display="block"})),document.getElementById("info-tab1").addEventListener("click",(function(){let e=document.getElementById("validation"),t=document.getElementById("info");e.style.display="none",t.style.display="block"})),document.getElementById("validation-tab").addEventListener("click",(function(){let e=document.getElementById("validation"),t=document.getElementById("info");e.style.display="block",t.style.display="none"})),document.getElementById("validation-tab1").addEventListener("click",(function(){let e=document.getElementById("validation"),t=document.getElementById("info");e.style.display="block",t.style.display="none"}))}()}function v(e=-1,t,i){!function(){var e=document.getElementById("vnpt_ekyc");e.insertAdjacentHTML("beforeend","<div class='step1-demo-ekyc' id='step1-demo-ekyc'><ul class='progressbar progressbar2' id='progressbar'><li class='active complete' id='progress-step0'>Mặt trước</li><li id='progress-step1'>Chân dung</li><li id='progress-step2'>Kết quả</li></ul><div class='ekyc-popup' id='ekyc-popup-1'><div class='pu-header'><img class='close-btn' id='close-pop-1' width='32px' height='32px' src='https://ekyc.bionicmachine.co/images/remove_icon.png' /><div class='icons'><img class='main-icons' src='https://ekyc.bionicmachine.co/images/touch_cmt.png' /></div><div class='content'>Hướng dẫn Chụp ảnh giấy tờ cầm tay</div></div><div class='pu-body'><ul><li>Đưa giấy tờ vào gần camera sao cho 4 góc của giấy tờ trùng với vùng giới hạn</li><li>Chụp rõ nét và đầy đủ thông tin trên giấy tờ</li></ul></div><div class='pu-footer'><img class='main-icons' src='https://ekyc.bionicmachine.co/images/cmt_noitice1.svg'/><img class='main-icons' src='https://ekyc.bionicmachine.co/images/cmt_noitice2.svg'/><img class='main-icons' src='https://ekyc.bionicmachine.co/images/cmt_noitice3.svg'/></div></div><div class='ekyc-popup' id='ekyc-popup-2'><div class='pu-header'><img class='close-btn' id='close-pop-2' width='32px' height='32px' src='https://ekyc.bionicmachine.co/images/remove_icon.png' /><div class='icons'><img class='main-icons' src='https://ekyc.bionicmachine.co/images/portrait_icon.png' /></div><div class='content'>Hướng dẫn Chụp ảnh Chân dung</div></div><div class='pu-body'><ul><li>Di chuyển khuôn mặt sao cho vừa với vùng giới hạn</li><li>Giữ nguyên khuôn mặt khi chụp ảnh</li><li>Hạn chế có người khác trong camera khi chụp</li></ul></div><div class='pu-footer'><img class='main-icons' src='https://ekyc.bionicmachine.co/images/portrait_noitice_1.svg'/><img class='main-icons' src='https://ekyc.bionicmachine.co/images/portrait_noitice_2.svg'/><img class='main-icons' src='https://ekyc.bionicmachine.co/images/portrait_noitice_3.svg'/></div></div><img id='tutorial_btn' class='tutorial_btn' src='https://ekyc.bionicmachine.co/images/tutorial_btn.png'></img><div class='webcame-zone' id='webcame-zone'><div class='video-block' id='video-block'><video class='action-block' id='video' autoplay='true'></video></div><div id='canvas-border'><canvas id='canvas' style='overflow:auto; display:none'></canvas></div></div><div class='ekyc_description' id='ekyc_description'><span>Xin vui lòng</span><br/><span>Đặt giấy tờ nằm vừa khung hình chữ nhật, chụp đủ ánh sáng và rõ nét</span></div><div class='ekyc_description' id='ekyc_description2'><span>Xin vui lòng</span><br/><span>Di chuyển khuôn mặt sao cho vừa với vùng giới hạn</span></div><div class='take-picture-btn' id='take-picture-step1'><img class='camera-icon' src='https://ekyc.bionicmachine.co/images/capture_icon_w.png'></img><span class='title'>Chụp ảnh</span></div><div class='step1-after-capture' id='step1-after-capture'><div class='re-capture' id='step1-re-capture'><img class='camera-icon' src='https://ekyc.bionicmachine.co/images/capture_icon_b.png'></img><span>Chụp lại</span></div><div class='next-step' id='step1-next-step'><img class='next-icon' src='https://ekyc.bionicmachine.co/images/next_icon_b.png'></img><span>Tiếp theo</span></div></div><div id='dropZone' class='id-card'><div class='capture-btn-wrapper'><img class='img-capture-mobile' src='https://ekyc.bionicmachine.co/images/capure_mobile.png'></img><input id='fileInputMobile' type='file' accept='image/*' capture='environment'><div style='color: #18d696'>Chạm để chụp ảnh</div></div></div><div class='preview' id='previewZone'><img id='preview-img' src='' alt='preview' /></div><div class='ekyc_description' id='ekyc_description_mobile1' ><span>Xin vui lòng</span><br/><span>Đặt giấy tờ nằm vừa khung hình chữ nhật,</span><br/><span> chụp đủ ánh sáng và rõ nét</span></div><div class='ekyc_description' id='ekyc_description_mobile2'><span>Xin vui lòng</span><br/><span>Di chuyển khuôn mặt sao cho vừa </span><br/><span>với vùng giới hạn</span></div><div class='mobile-after-capture' id='mobile-after-capture'><div class='upload-btn-wrapper'><button class='btn-active'><img class='camera-icon' src='https://ekyc.bionicmachine.co/images/capture_icon_b.png'></img><span>Chụp lại</span></button><input id='fileInputMobile1' type='file' accept='image/*' capture='environment'></div><div class='next-step' id='mobile-next-step'><img class='next-icon' src='https://ekyc.bionicmachine.co/images/next_icon_b.png'></img><span>Tiếp theo</span></div></div><div class='tutorial-mobile'><a id='tutorial-mobile'>Hướng dẫn</a></div></div>"),document.getElementById("step1-after-capture").style.display="none";var i=document.querySelector("#video");document.getElementById("ekyc_description").style.display="none",document.getElementById("webcame-zone").style.display="none",document.getElementById("ekyc_description2").style.display="none",document.getElementById("take-picture-step1").style.display="none",document.getElementById("ekyc-popup-2").style.display="none",document.getElementById("dropZone").style.display="none",document.getElementById("ekyc_description_mobile1").style.display="none",document.getElementById("tutorial-mobile").style.display="none";try{var m=window.screen.width<window.outerWidth?window.screen.width:window.outerWidth;if(navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,m>500&&navigator.mediaDevices.getUserMedia){var g={audio:!1,video:{facingMode:"user"}};navigator.mediaDevices.getUserMedia(g).then((function(e){if(i.srcObject=e,(e.getVideoTracks()[0].label?e.getVideoTracks()[0].label.toLowerCase():"anonymous").includes("fake")){let t=d("VnVpIGzDsm5nIGtp4buDbSB0cmEgY2FtZXJhIGPhu6dhIGLhuqFuICE=");alert(t),_(e),location.reload()}else i.play(),document.getElementById("take-picture-step1").addEventListener("click",(function(){p+=1;var e=document.getElementById("canvas"),i=document.getElementById("video"),d=document.getElementById("tutorial_btn"),m=Math.round(i.videoHeight/(i.videoWidth/n));d.style.display="none",e.width=n,e.height=m,e.getContext("2d").drawImage(i,0,0,n,m),h=s(h=e.toDataURL("image/jpeg"),n,m),document.getElementById("canvas-border").style.height=m+"px";var g={image_type:"jpeg",width:n,height:m,brand:"wb",date_taken:o(new Date),soft_ware:"vnpt_ekyc"};r=l(g,"3cb7ecbd-2343-4272-b2f1-cdb12983ecc0");var u,f=a(h);if(1===p){var _=b+"file-service/v1/addFile";(u=new FormData).append("file\t",f),u.append("title\t","upload_cmt_front"),u.append("description\t","upload_cmt_front"),y.img_front=h,c(_,{},u,e=>{var i=JSON.parse(e);v.img_front=i.object.hash,k(b+"ai/v2/web/card/liveness",i.object.hash,"liveness_card_front",t.CHECK_LIVENESS_CARD)},e=>{console.log(e)},t),document.getElementById("step1-next-step").setAttribute("data-step",p)}2===p&&(_=b+"file-service/v1/addFile",(u=new FormData).append("file\t",f),u.append("title\t","upload_face_image"),u.append("description\t","upload_face_image"),y.img_face=h,c(_,{},u,e=>{var i=JSON.parse(e);v.img_face=i.object.hash,E(b+"ai/v2/web/face/liveness",i.object.hash,"liveness_face",t.CHECK_LIVENESS_FACE)},e=>{console.log(e)},t),document.getElementById("step1-next-step").setAttribute("data-step",p));let I=document.getElementById("video-block"),B=document.getElementById("canvas-border");e.style.display="block",B.style.display="block",I.style.display="none",this.style.display="none",document.getElementById("step1-after-capture").style.display="flex",bodymovin.loadAnimation({container:document.getElementById("canvas-border"),renderer:"svg",loop:!1,autoplay:!0,name:"Hello World"})})),function(e=""){document.getElementById("step1-next-step").onclick=function(){let t=this.getAttribute("data-step"),i=document.getElementById("video-block"),n=document.getElementById("tutorial_btn");(n.style.display="block",S("progress-step"+t),document.getElementById("step1-after-capture").style.display="none",i.style.display="block",canvas.style.display="none",document.getElementById("take-picture-step1").style.display="flex",f(),1==t)&&(j(),document.getElementById("ekyc-popup-2").style.display="block",n.style.display="none",I(b+"ai/v2/web/ocr/id/front"),document.getElementById("ekyc_description").style.display="none");if(2==t){B(b+"ai/v2/web/face/compare"),w(b+"ai/v2/web/face/mask"),document.getElementById("step1-demo-ekyc").style.display="none";var c="<div class='ekyc-loading' id='ekyc-loading'><div class='arc'></div></div>";document.getElementById("vnpt_ekyc").insertAdjacentHTML("beforeend",c),_(e),u.image_base64=y}}}(e)})).catch((function(e){console.log("Something went wrong!",e);let t=d("VnVpIGzDsm5nIGtp4buDbSB0cmEgY2FtZXJhIGPhu6dhIGLhuqFuICE=");alert(t)}))}}catch(e){console.log("webcam err",e)}document.getElementById("fileInputMobile").onchange=function(e){let t=new FileReader,i=this.files[0];t.onloadend=e=>{i&&C(i,e.target.result),document.getElementById("dropZone").style.display="none",document.getElementById("previewZone").style.display="block",document.getElementById("preview-img").src=t.result,document.getElementById("mobile-after-capture").style.display="flex",document.getElementById("tutorial-mobile").style.display="none"},t.readAsDataURL(i)},document.getElementById("fileInputMobile1").onchange=function(e){let t=new FileReader,i=this.files[0];t.onloadend=e=>{i&&C(i,e.target.result),document.getElementById("dropZone").style.display="none",document.getElementById("previewZone").style.display="block",document.getElementById("preview-img").src=t.result,document.getElementById("mobile-after-capture").style.display="flex"},t.readAsDataURL(i)},document.getElementById("tutorial_btn").onclick=function(){parseInt(p)<=1?(j(),document.getElementById("ekyc-popup-1").style.display="block"):(j(),document.getElementById("ekyc-popup-2").style.display="block")},document.getElementById("tutorial-mobile").onclick=function(){parseInt(p)<=1?(document.getElementById("ekyc-popup-1").style.display="block",document.getElementById("dropZone").style.display="none",document.getElementById("ekyc_description_mobile1").style.display="none",document.getElementById("tutorial-mobile").style.display="none"):(document.getElementById("ekyc-popup-2").style.display="block",document.getElementById("dropZone").style.display="none",document.getElementById("ekyc_description_mobile2").style.display="none",document.getElementById("tutorial-mobile").style.display="none")},document.getElementById("close-pop-1").onclick=function(){(window.screen.width<window.outerWidth?window.screen.width:window.outerWidth)<500?(document.getElementById("ekyc-popup-1").style.display="none",document.getElementById("dropZone").style.display="block",document.getElementById("ekyc_description_mobile1").style.display="block",document.getElementById("tutorial-mobile").style.display="block",document.getElementById("tutorial-mobile").style.color="#18D696",document.getElementById("ekyc_description").style.display="none"):(document.getElementById("webcame-zone").style.display="block",document.getElementById("ekyc-popup-1").style.display="none",document.getElementById("take-picture-step1").style.display="flex",document.getElementById("ekyc_description").style.display="block",document.getElementById("tutorial_btn").style.display="block")},document.getElementById("close-pop-2").onclick=function(){(window.screen.width<window.outerWidth?window.screen.width:window.outerWidth)<500?(document.getElementById("ekyc-popup-2").style.display="none",document.getElementById("dropZone").style.display="block",document.getElementById("ekyc_description_mobile2").style.display="block",document.getElementById("tutorial-mobile").style.display="block",document.getElementById("tutorial-mobile").style.color="#18D696",document.getElementById("ekyc_description").style.display="none"):(document.getElementById("webcame-zone").style.display="block",document.getElementById("ekyc-popup-2").style.display="none",document.getElementById("take-picture-step1").style.display="flex",document.getElementById("ekyc_description2").style.display="block",document.getElementById("tutorial_btn").style.display="block")},document.getElementById("tutorial_btn").onclick=function(){0==parseInt(p)?(j(),document.getElementById("ekyc-popup-1").style.display="block"):(j(),document.getElementById("ekyc-popup-2").style.display="block")}}(),document.getElementById("step1-re-capture").addEventListener("click",(function(){let e=document.getElementById("video-block");p-=1,document.getElementById("step1-after-capture").style.display="none",e.style.display="block",document.getElementById("take-picture-step1").style.display="flex",document.getElementById("tutorial_btn").style.display="block",f()}));var n=400,r=null,p=0,v={},y={},g={},u={type_document:e},b="https://api.idg.vnpt.vn/";var h="";function f(){let e="";document.getElementById("canvas-border").remove(),e="<div id='canvas-border'><canvas id='canvas' style='overflow:auto; display:none'></canvas></div>",document.getElementById("webcame-zone").insertAdjacentHTML("beforeend","<div id='canvas-border'><canvas id='canvas' style='overflow:auto; display:none'></canvas></div>"),document.getElementById("canvas-border").style.display="none"}function _(e){e.getTracks().forEach((function(e){"live"==e.readyState&&e.stop()}))}function k(e,i,n,o=!1){let s={img:i,client_session:"9fb8ee41-1b6d-45c9-9ff4-645bb269df7e-1566189277196",token:"sdk-web-e41-1b6d-45c9-9",optimizer:r};c(e,{key:"Content-Type",value:"application/json"},JSON.stringify(s),e=>{let t=JSON.parse(e);g[n]=t.object,console.log("result_liveness",o),u[n]=o?t:null,localStorage.ekyc_result=JSON.stringify(u)},e=>{console.log(e),u[n]=JSON.parse(e)},t)}function E(e,i,n,o=!1){let s={img:i,client_session:"9fb8ee41-1b6d-45c9-9ff4-645bb269df7e-1566189277196",token:"sdk-web-e41-1b6d-45c9-9",optimizer:r};c(e,{key:"Content-Type",value:"application/json"},JSON.stringify(s),e=>{let t=JSON.parse(e);g[n]=t.object,u[n]=o?t:null,localStorage.ekyc_result=JSON.stringify(u)},e=>{console.log(e),u[n]=JSON.parse(e)},t)}function I(i,n=!0){var o={img_front:v.img_front,client_session:"9fb8ee41-1b6d-45c9-9ff4-645bb269df7e-1566189277196",token:"e41-1b6d-45c9-9",type:e,validate_postcode:!0,optimizer:r};c(i,{key:"Content-Type",value:"application/json"},JSON.stringify(o),e=>{var t=JSON.parse(e);g.ocr=t,u.ocr=n?t:null,localStorage.ekyc_result=JSON.stringify(u)},e=>{console.log(e),u.ocr=JSON.parse(e)},t)}function B(e,n=!0){var o={img_front:v.img_front,img_face:v.img_face,client_session:"9fb8ee41-1b6d-45c9-9ff4-645bb269df7e-1566189277196",token:"abc",optimizer:r};g.image_base64=y,c(e,{key:"Content-Type",value:"application/json"},JSON.stringify(o),(function(e){var c=JSON.parse(e);g.compare=c,u.hash_img=v,u.compare=n?c:null,i(u),localStorage.ekyc_result=JSON.stringify(u),document.getElementById("ekyc-loading")&&(document.getElementById("ekyc-loading").style.display="none"),t.VIEW_RESULT_DEFAULT&&m(g,t)}),(function(e){u.compare=JSON.parse(e),i(u),document.getElementById("ekyc-loading")&&(document.getElementById("ekyc-loading").style.display="none"),t.VIEW_RESULT_DEFAULT&&m(g,t)}),t)}function w(e,i=!1){let n={img:v.img_face,face_bbox:"136;95;530;569",face_lmark:"235;309;390;248;346;375;325;477;450;428",client_session:"9fb8ee41-1b6d-45c9-9ff4-645bb269df7e-1566189277196",optimizer:r};c(e,{key:"Content-Type",value:"application/json"},JSON.stringify(n),e=>{var t=JSON.parse(e);g.masked=t,u.masked=i?t:null,localStorage.ekyc_result=JSON.stringify(u)},e=>{console.log(e),u.masked=JSON.parse(e)},t)}function S(e){var t=document.querySelectorAll(".active");[].forEach.call(t,(function(e){e.classList.remove("active")}));!e.includes("undefined")&&(document.getElementById(e).className="active complete")}function j(){document.getElementById("webcame-zone").style.display="none",document.getElementById("take-picture-step1").style.display="none",document.getElementById("ekyc_description").style.display="none",document.getElementById("ekyc_description2").style.display="none",document.getElementById("tutorial_btn").style.display="none"}function C(e,i){document.getElementById("mobile-next-step").onclick=function(){p+=1;!function(e,i,n){try{var o=b+"file-service/v1/addFile";console.log("BASE_URL_API",b);var s=new FormData;s.append("file\t",e),s.append("title\t","upload_cmt_front"),s.append("description\t","upload_cmt_front"),c(o,{},s,e=>{i(e)},e=>{n(e)},t)}catch(e){console.log("err",e)}}(e,e=>{var n=JSON.parse(e);if(1===p&&(v.img_front=n.object.hash,y.img_front=i,k(b+"ai/v1/web/card/liveness",n.object.hash,"liveness_card_front",t.CHECK_LIVENESS_CARD),document.getElementById("dropZone").style.display="block",document.getElementById("previewZone").style.display="none",document.getElementById("preview-img").src="",document.getElementById("ekyc-popup-2").style.display="block",document.getElementById("tutorial-mobile").style.display="none",document.getElementById("dropZone").style.display="none",document.getElementById("ekyc_description_mobile1").style.display="none"),2===p){document.getElementById("vnpt_ekyc").insertAdjacentHTML("beforeend","<div class='ekyc-loading' id='ekyc-loading'><div class='arc'></div></div>"),v.img_face=n.object.hash,y.img_face=i,u.image_base64=y,E(b+"ai/v1/web/face/liveness",n.object.hash,"liveness_face",t.CHECK_LIVENESS_FACE),I(b+"ai/v1/web/ocr/id/front"),B(b+"ai/v1/web/face/compare"),w(b+"ai/v1/web/face/mask"),document.getElementById("previewZone").style.display="none";let e=document.getElementById("step1-demo-ekyc");e.parentNode.removeChild(e)}},e=>{console.log("hahah",e)}),S("progress-step"+p),document.getElementById("dropZone").style.display="block",document.getElementById("tutorial-mobile").style.display="block",document.getElementById("previewZone").style.display="none",document.getElementById("mobile-after-capture").style.display="none"}}}function y(e,t){!function(e,t){!function(){localStorage.removeItem("v_ekyc_actk"),localStorage.removeItem("gg-tk");var i=document.createElement("script");i.id="recapcha_v2_id",i.src="https://www.google.com/recaptcha/api.js?onload=loadCaptcha&render=explicit",i.async=!0,i.defe=!0;var c=document.createElement("script");c.id="piexif_id",c.src="https://cdn.jsdelivr.net/npm/piexifjs@1.0.6/piexif.js",c.async=!0,c.defe=!0;var o=document.createElement("script");o.id="crypto_id",o.src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.2/rollups/aes.js",o.async=!0,o.defe=!0;var s=document.createElement("script");s.id="lottie_id",s.src="https://cdnjs.cloudflare.com/ajax/libs/bodymovin/5.7.4/lottie.min.js",s.async=!0,s.defe=!0,document.body.appendChild(i),document.body.appendChild(c),document.body.appendChild(o),document.body.appendChild(s);var l="<div id='vnpt_ekyc'><div class='home-demo-ekyc' id='home-demo-ekyc'><div class='title'> CHỌN LOẠI GIẤY TỜ </div><div class='list-choose'><div class='item' id='verification-id' tabindex='1'> <img src='https://ekyc.bionicmachine.co/images/cmt.png'/><span class='title'>Chứng minh thư, Thẻ căn cước</span></div><div class='item' id='verification-passport' tabindex='2'> <img src='https://ekyc.bionicmachine.co/images/passport.png'/><span class='title'>Hộ chiếu</span></div><div class='item' id='verification-army-id' tabindex='3'> <img src='https://ekyc.bionicmachine.co/images/other_doc.png'/><span class='title'>Chứng minh thư quân đội</span></div><div class='item' id='verification-card-drive' tabindex='4'> <img src='https://ekyc.bionicmachine.co/images/car_id.png'/><span class='title'>Bằng lái xe</span></div>"+(e.ENABLE_GGCAPCHAR,"<div class='start-demo' id='start-demo-ekyc' tabindex='6'><span class='label-cus'>BẮT ĐẦU</span></div></div></div></div>");document.getElementById("vnpt_ekyc")||document.getElementById(e.PARRENT_ID).insertAdjacentHTML("beforeend",l);var d="",a=null;function r(e,t){d=e.id;let i=e.querySelectorAll(".title")[0];e.querySelectorAll(".checkbox")[0],e.style.background="#18D696",i.style.color="#FFFFFF",a=t}function m(e,t){let i=document.getElementById(d),n=i.querySelectorAll(".title")[0];i.querySelectorAll(".checkbox")[0],i.style.background="#FFFFFF",n.style.color="#111127";let c=e.querySelectorAll(".title")[0];e.querySelectorAll(".checkbox")[0],e.style.background="#18D696",c.style.color="#FFFFFF",d=e.id,a=t}document.getElementById("verification-id").addEventListener("click",(function(){n(d)&&r(this,-1),d!=this.id&&m(this,-1)})),document.getElementById("verification-passport").addEventListener("click",(function(){n(d)&&r(this,5),d!=this.id&&m(this,5)})),document.getElementById("verification-army-id").addEventListener("click",(function(){n(d)&&r(this,7),d!=this.id&&m(this,7)})),document.getElementById("verification-card-drive").addEventListener("click",(function(){n(d)&&r(this,6),d!=this.id&&m(this,6)})),document.getElementById("start-demo-ekyc").addEventListener("click",(function(){n(d)?alert("Bạn phải chọn loại giấy tờ trước khi tiếp tục"):(document.getElementById("home-demo-ekyc").style.display="none",5!=a&&6!=a||v(a,e,t),-1!=a&&7!=a||p(a,e,t))}))}()}(e,t)}function g(e,t){let i=document.getElementById("vnpt_ekyc");i&&i.parentNode.removeChild(i),y(e,t)}i.r(t),i.d(t,"init",(function(){return y})),i.d(t,"reload",(function(){return g}))}]);